---
title: "STA 325 Case Study"
author: "Abby L., Ava E., Ella T., Grady P. Laura C."
output: pdf_document
---
```{r, echo=FALSE, message=FALSE}
# Loading packages and data
library(tidyverse)
library(dplyr)
library(ggplot2)
library(moments)
library(glmnet)  
library(splines) 
library(caret)
library(boot)
library(olsrr)
library(MASS)

# Loading the data
data <- read.csv("~/STA-325-Case-Study/Individual Case Study First Steps/data_transformed.csv")
```


# Introduction

Whether it’s stirring a morning cup of coffee or feeling your stomach lurch during a bumpy airplane ride, nearly everyone has experienced some form of turbulence. Beyond these everyday encounters, turbulence plays a crucial role in many complex natural and industrial processes, from air pollution and chemical reactions to heat transfer and weather systems. Despite its ubiquity, turbulence remains notoriously difficult to predict and has long been regarded as “the last great unsolved problem in classical physics.”

While we may not be physicists ourselves, as members of Stat 325, we have undertaken the challenge of developing a predictive model to better understand this elusive phenomenon in collaboration with our Professor, Simon Mak. Specifically, we have explored models designed to predict the mean, standard deviation, skewness, and kurtosis of turbulence. Our goal is to create a model that balances predictive accuracy with interpretability; one that not only performs well statistically but also provides clear, meaningful insights into how different conditions influence turbulent behavior.


### Exploratory Data Analysis

```{r}
# Create long-format dataset with Variable and Transformation columns
data_long <- data %>%
  select(Fr, Re, St) %>%
  pivot_longer(cols = everything(),
               names_to = "Variable",
               values_to = "Value") %>%
  mutate(Transformation = "Original") %>%
  bind_rows(
    data %>%
      select(Fr, Re, St) %>%
      mutate(across(everything(), sqrt)) %>%
      pivot_longer(cols = everything(), 
                   names_to = "Variable", 
                   values_to = "Value") %>%
      mutate(Transformation = "Sqrt")
  ) %>%
  bind_rows(
    data %>%
      select(Fr, Re, St) %>%
      mutate(across(everything(), log)) %>%
      pivot_longer(cols = everything(), 
                   names_to = "Variable", 
                   values_to = "Value") %>%
      mutate(Transformation = "Log")
  )

ggplot(data_long, aes(x = Value, fill = Transformation)) +
  geom_histogram(bins = 30, color = "black", alpha = 0.7) +
  facet_grid(Variable ~ Transformation, scales = "free") +
  scale_fill_manual(values = c("Original" = "skyblue", "Sqrt" = "lightgreen", 
                               "Log" = "salmon")) +
  labs(title = "Histograms of Fr, Re, St (Original, Sqrt, Log)",
       x = "Value", y = "Count") +
  theme_minimal()


```


```{r}
# install.packages("corrplot") # only if not installed
library(corrplot)

# Select relevant variables from your dataset
vars <- data[, c("Re", "St_sqrt", "logistic_Fr", 
                 "R_moment_1", "R_moment_2", "R_moment_3", "R_moment_4")]

# Compute correlation matrix
corr_matrix <- cor(vars, use = "complete.obs")  # handles missing values

# Plot correlation matrix
corrplot(corr_matrix, method = "color", 
         type = "upper", 
         addCoef.col = "black",  # show correlation coefficients
         tl.col = "black",       # axis labels color
         tl.srt = 45)            # label rotation
```


# Methodology

## Skew

Looking at the distribution of a Skew through the EDA and Box-Cox transformation (below), a square root transformation on Skew was deemed most appropriate to address the skewness of the response variable.

```{r, echo=FALSE, fig.asp=0.5}
boxcox(lm(data$skewness ~ 1))
```



# Results


# Conclusion